{
  "query": "\n-- Verificar se ainda existem reservas 처rf찾s\nSELECT \n  i.id as inventoryId,\n  p.sku,\n  p.description as productName,\n  wl.code as locationCode,\n  i.reservedQuantity,\n  COALESCE(active_reserves.totalReserved, 0) as reservasReaisAtivas,\n  (i.reservedQuantity - COALESCE(active_reserves.totalReserved, 0)) as reservaOrfa\nFROM inventory i\nINNER JOIN products p ON i.productId = p.id\nINNER JOIN warehouseLocations wl ON i.locationId = wl.id\nLEFT JOIN (\n  SELECT \n    poi.productId,\n    poi.batch,\n    SUM(\n      CASE \n        WHEN poi.unit = 'box' THEN poi.requestedQuantity * COALESCE(p.unitsPerBox, 1)\n        ELSE poi.requestedQuantity\n      END\n    ) as totalReserved\n  FROM pickingOrderItems poi\n  INNER JOIN pickingOrders po ON poi.pickingOrderId = po.id\n  INNER JOIN products p ON poi.productId = p.id\n  WHERE po.status IN ('pending', 'in_progress', 'separated', 'in_wave')\n  GROUP BY poi.productId, poi.batch\n) active_reserves ON i.productId = active_reserves.productId \n  AND (i.batch = active_reserves.batch OR (i.batch IS NULL AND active_reserves.batch IS NULL))\nWHERE i.reservedQuantity > 0\n  AND i.reservedQuantity != COALESCE(active_reserves.totalReserved, 0);\n",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 44TTARZqZm4zxSK.6207e12656da --database YB8JBMXFWs4i38ecUvjPnS --execute \n-- Verificar se ainda existem reservas 처rf찾s\nSELECT \n  i.id as inventoryId,\n  p.sku,\n  p.description as productName,\n  wl.code as locationCode,\n  i.reservedQuantity,\n  COALESCE(active_reserves.totalReserved, 0) as reservasReaisAtivas,\n  (i.reservedQuantity - COALESCE(active_reserves.totalReserved, 0)) as reservaOrfa\nFROM inventory i\nINNER JOIN products p ON i.productId = p.id\nINNER JOIN warehouseLocations wl ON i.locationId = wl.id\nLEFT JOIN (\n  SELECT \n    poi.productId,\n    poi.batch,\n    SUM(\n      CASE \n        WHEN poi.unit = 'box' THEN poi.requestedQuantity * COALESCE(p.unitsPerBox, 1)\n        ELSE poi.requestedQuantity\n      END\n    ) as totalReserved\n  FROM pickingOrderItems poi\n  INNER JOIN pickingOrders po ON poi.pickingOrderId = po.id\n  INNER JOIN products p ON poi.productId = p.id\n  WHERE po.status IN ('pending', 'in_progress', 'separated', 'in_wave')\n  GROUP BY poi.productId, poi.batch\n) active_reserves ON i.productId = active_reserves.productId \n  AND (i.batch = active_reserves.batch OR (i.batch IS NULL AND active_reserves.batch IS NULL))\nWHERE i.reservedQuantity > 0\n  AND i.reservedQuantity != COALESCE(active_reserves.totalReserved, 0);\n",
  "rows": [],
  "messages": [],
  "stdout": "",
  "stderr": "",
  "execution_time_ms": 350
}